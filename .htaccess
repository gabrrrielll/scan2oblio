# Enable rewrite engine
RewriteEngine On

# Set proper MIME types (CRITICAL for static assets)
<IfModule mod_mime.c>
    AddType application/javascript .js
    AddType application/javascript .mjs
    AddType text/css .css
    AddType application/json .json
    AddType image/svg+xml .svg
</IfModule>

# SPA Routing for /scan/ - serving from dist folder
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /scan/
  
  # If the request is for a file that exists in dist/, serve it
  RewriteCond %{DOCUMENT_ROOT}/scan/dist/%{REQUEST_URI} -f
  RewriteRule ^(.*)$ dist/$1 [L]
  
  # Otherwise, route everything to dist/index.html
  RewriteRule ^index\.html$ dist/index.html [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . dist/index.html [L]
</IfModule>

# Security and CORS Headers
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
</IfModule>
